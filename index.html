<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gourmet Patagon - Multi-Pedido</title>
    <style>
        :root { --primary: #e67e22; --dark: #2c3e50; --success: #25d366; }
        body { font-family: 'Segoe UI', sans-serif; background: #fdfaf6; color: var(--dark); padding: 15px; margin: 0; }
        .container { max-width: 500px; margin: auto; background: white; padding: 20px; border-radius: 20px; box-shadow: 0 10px 25px rgba(0,0,0,0.1); }
        .header { text-align: center; border-bottom: 2px solid var(--primary); margin-bottom: 15px; }
        .step { margin-bottom: 20px; padding: 10px; border: 1px solid #f0f0f0; border-radius: 12px; }
        h3 { font-size: 0.9rem; color: var(--primary); text-transform: uppercase; margin-top: 0; }
        input, select, textarea { width: 100%; padding: 12px; margin: 5px 0; border: 1px solid #ccc; border-radius: 8px; box-sizing: border-box; }
        .grid-options { display: grid; grid-template-columns: 1fr 1fr; gap: 8px; }
        .opt-card { border: 1px solid #ddd; padding: 10px; border-radius: 10px; text-align: center; cursor: pointer; font-size: 0.85rem; }
        .opt-card input { display: none; }
        .opt-card:has(input:checked) { border-color: var(--primary); background: #fff5eb; border-width: 2px; }
        .cart-item { background: #f9f9f9; padding: 10px; margin: 5px 0; border-radius: 8px; font-size: 0.85rem; border-left: 4px solid var(--primary); }
        .total-box { background: var(--dark); color: white; padding: 15px; border-radius: 12px; text-align: center; font-weight: bold; font-size: 1.1rem; margin: 15px 0; }
        .btn-add { background: var(--dark); color: white; border: none; padding: 10px; border-radius: 8px; width: 100%; cursor: pointer; font-weight: bold; margin-bottom: 10px; }
        .btn-send { background: var(--success); color: white; border: none; padding: 18px; border-radius: 12px; width: 100%; font-size: 1.1rem; font-weight: 800; cursor: pointer; }
        .warning { background: #fff3cd; padding: 8px; border-radius: 8px; font-size: 0.75rem; border-left: 4px solid #ffc107; }
    </style>
</head>
<body>

<div class="container">
    <div class="header">
        <h2>üèîÔ∏è EL GOURMET PATAGON</h2>
        <p><i>Cocina Taller - Multi-Pedido</i></p>
    </div>

    <div class="step">
        <h3>1. Datos de Entrega</h3>
        <input type="text" id="nombre" placeholder="Tu Nombre">
        <input type="text" id="direccion" placeholder="Direcci√≥n / Punto de Encuentro">
        <select id="zona" onchange="renderCart()">
            <option value="0">Retiro / Centro hasta Victoria ($0)</option>
            <option value="1500">Sobre Victoria (+$1.500)</option>
        </select>
        <div class="warning">
            <input type="checkbox" id="ruta" checked> Acepto entrega en Hoja de Ruta (12:45-14:00) ‚úÖ
        </div>
    </div>

    <div class="step" style="background: #fffdf9;">
        <h3>2. Configura un Men√∫</h3>
        <div class="grid-options">
            <label class="opt-card"><input type="radio" name="combo" value="6500" data-name="Men√∫ A"><b>Men√∫ A</b><br>$6.500</label>
            <label class="opt-card"><input type="radio" name="combo" value="7500" data-name="Men√∫ B"><b>Men√∫ B</b><br>$7.500</label>
            <label class="opt-card"><input type="radio" name="combo" value="3500" data-name="Pa'l Fr√≠o"><b>Pa'l Fr√≠o</b><br>$3.500</label>
            <label class="opt-card"><input type="radio" name="combo" value="3500" data-name="Waffle"><b>Waffle</b><br>$3.500</label>
        </div>
        
        <select id="detalle_plato" style="margin-top:10px;">
            <option value="Entrante: Sopa/Crema + Principal: Caliente">Sopa + Principal Caliente ü•ò</option>
            <option value="Entrante: Mix Temporada + Principal: Caliente">Mix Ensalada + Principal Caliente ü•ò</option>
            <option value="Principal: La Gran Ensalada">Solo La Gran Ensalada ü•ó</option>
        </select>

        <div id="prot_sec" style="font-size: 0.8rem; margin-top: 5px;">
            <label><b>Prote√≠nas (Si elegiste Gran Ensalada):</b></label><br>
            <input type="checkbox" class="prot" value="Ave"> Ave | 
            <input type="checkbox" class="prot" value="Huevo"> Huevo | 
            <input type="checkbox" class="prot" value="Quinoa"> Quinoa | 
            <input type="checkbox" class="prot" value="Legumbre"> Legumbre
        </div>
        
        <button class="btn-add" onclick="addToCart()" style="margin-top:10px;">‚ûï A√ëADIR ESTE MEN√ö</button>
    </div>

    <div id="cart_display"></div>
    
    <div class="step">
        <label><input type="checkbox" id="cubiertos" onchange="renderCart()"> ü•¢ Agregar Cubiertos Bamboo (+$1.000)</label>
    </div>

    <div class="total-box" id="total_final">TOTAL: $0</div>
    <button class="btn-send" onclick="sendOrder()">ENVIAR PEDIDO COMPLETO üì≤</button>
</div>

<script>
    let cart = [];

    function addToCart() {
        const combo = document.querySelector('input[name="combo"]:checked');
        if(!combo) return alert("Selecciona un combo");
        
        const proteins = Array.from(document.querySelectorAll('.prot:checked')).map(p => p.value);
        
        const item = {
            name: combo.dataset.name,
            price: parseInt(combo.value),
            detail: document.getElementById('detalle_plato').value,
            prots: proteins.join("-")
        };
        
        cart.push(item);
        renderCart();
        // Reset solo selecci√≥n de plato
        document.querySelectorAll('.prot').forEach(p => p.checked = false);
    }

    function renderCart() {
        const container = document.getElementById('cart_display');
        container.innerHTML = "<h3>Resumen de Pedido:</h3>";
        let subtotal = 0;
        
        cart.forEach((item, index) => {
            subtotal += item.price;
            container.innerHTML += `
                <div class="cart-item">
                    <b>${item.name}</b> ($${item.price}) <br>
                    <small>${item.detail} ${item.prots ? '['+item.prots+']' : ''}</small>
                    <button onclick="cart.splice(${index},1);renderCart()" style="float:right; border:none; background:none; color:red;">‚ùå</button>
                </div>`;
        });

        const zona = parseInt(document.getElementById('zona').value);
        const cubiertos = document.getElementById('cubiertos').checked ? 1000 : 0;
        const total = subtotal + zona + cubiertos;
        
        document.getElementById('total_final').innerText = "TOTAL: $" + total.toLocaleString('es-CL');
        return { total, subtotal, zona, cubiertos };
    }

    function sendOrder() {
        const nombre = document.getElementById('nombre').value;
        const direccion = document.getElementById('direccion').value;
        if(cart.length === 0 || !nombre) return alert("Agrega al menos un men√∫ y tu nombre");

        let msg = `*NUEVA COMANDA - EL GOURMET PATAGON*%0A`;
        msg += `üë§ *Cliente:* ${nombre}%0A`;
        msg += `üìç *Lugar:* ${direccion}%0A%0A`;
        
        cart.forEach((item, i) => {
            msg += `üç¥ *Men√∫ ${i+1}:* ${item.name}%0A   _${item.detail}_%0A`;
            if(item.prots) msg += `   _Prote√≠nas: ${item.prots}_%0A`;
        });

        const r = renderCart();
        if(r.cubiertos > 0) msg += `%0Aü•¢ *Incluye Cubiertos Bamboo*%0A`;
        msg += `%0Aüöö *Env√≠o:* $${r.zona}%0A`;
        msg += `üí∞ *TOTAL A PAGAR: $${r.total}*%0A%0A`;
        msg += `üïí *Hoja de ruta:* Aceptada`;

        window.open(`https://wa.me/56994004188?text=${msg}`);
    }
</script>
</body>
</html>
