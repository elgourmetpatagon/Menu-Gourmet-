<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Gourmet Patagon v28</title>
    <style>
        :root { --primary: #e67e22; --dark: #2c3e50; --success: #25d366; --bg: #f4f7f6; --win: #27ae60; --shadow: 0 4px 15px rgba(0,0,0,0.08); }
        
        body { font-family: 'Inter', -apple-system, sans-serif; background: var(--bg); color: var(--dark); padding: 15px; margin: 0; line-height: 1.5; }
        .container { max-width: 500px; margin: auto; }

        /* Tarjetas de Secci√≥n */
        .card { background: white; border-radius: 20px; padding: 18px; margin-bottom: 15px; box-shadow: var(--shadow); border: 1px solid rgba(0,0,0,0.03); }
        
        .header { text-align: center; padding: 10px 0; }
        .header h2 { margin: 0; font-size: 1.4rem; letter-spacing: -0.5px; }
        .badge-taller { background: var(--primary); color: white; padding: 4px 12px; border-radius: 50px; font-size: 0.7rem; font-weight: 800; text-transform: uppercase; }

        .step-title { font-size: 0.85rem; font-weight: 800; color: #95a5a6; text-transform: uppercase; margin-bottom: 12px; display: flex; align-items: center; gap: 8px; }

        /* Grid de Combos Mejorado */
        .grid-combos { display: grid; grid-template-columns: 1fr 1fr; gap: 12px; }
        .combo-card { 
            border: 2px solid #edf2f7; padding: 15px; border-radius: 18px; text-align: center; 
            transition: 0.2s; position: relative; background: #fff; cursor: pointer;
        }
        .combo-card input { position: absolute; opacity: 0; }
        .combo-card:has(input:checked) { border-color: var(--primary); background: #fffaf5; transform: translateY(-3px); box-shadow: 0 6px 12px rgba(230,126,34,0.15); }
        .combo-card b { display: block; font-size: 1rem; margin-bottom: 4px; }
        .combo-card span { font-size: 0.75rem; color: #718096; display: block; margin-bottom: 8px; }
        .combo-card i { color: var(--primary); font-weight: 800; font-style: normal; font-size: 1.1rem; }

        /* Bot√≥n de Acci√≥n Principal */
        .btn-add { 
            background: #cbd5e0; color: white; padding: 18px; width: 100%; border-radius: 15px; 
            font-weight: 800; border: none; font-size: 1.1rem; margin-top: 10px; transition: 0.3s;
        }
        .btn-add-active { background: var(--primary); animation: glow 1.5s infinite; cursor: pointer; }
        @keyframes glow { 0% { box-shadow: 0 0 0 0 rgba(230,126,34,0.4); } 70% { box-shadow: 0 0 0 15px rgba(230,126,34,0); } 100% { box-shadow: 0 0 0 0 rgba(230,126,34,0); } }

        /* Carrito y Ahorro */
        .cart-item { background: #f8fafc; padding: 12px; border-radius: 12px; margin-bottom: 8px; display: flex; justify-content: space-between; align-items: center; border-left: 4px solid var(--primary); }
        .ahorro-tag { background: var(--win); color: white; padding: 10px; border-radius: 12px; text-align: center; font-weight: 700; font-size: 0.9rem; margin-top: 10px; animation: slideUp 0.3s ease; }
        @keyframes slideUp { from { transform: translateY(10px); opacity: 0; } to { transform: translateY(0); opacity: 1; } }

        /* Inputs Modernos */
        input[type="text"], input[type="number"], select, textarea { 
            width: 100%; padding: 14px; margin-bottom: 10px; border-radius: 12px; 
            border: 1px solid #e2e8f0; font-size: 16px; background: #fdfdfd;
        }
        input:focus { border-color: var(--primary); outline: none; background: #fff; }

        .total-box { background: var(--dark); color: white; padding: 20px; border-radius: 18px; text-align: center; margin: 20px 0; }
        .btn-send { background: var(--success); color: white; padding: 20px; width: 100%; border-radius: 15px; font-weight: 800; border: none; font-size: 1.2rem; box-shadow: 0 5px 15px rgba(37,211,102,0.3); }
    </style>
</head>
<body>

<div class="container">
    <div class="header">
        <span class="badge-taller">üèîÔ∏è Ays√©n - Chile</span>
        <h2>EL GOURMET PATAGON</h2>
    </div>

    <div class="card">
        <div class="step-title">üìç Paso 1: Log√≠stica</div>
        <input type="text" id="nombre" placeholder="¬øA qui√©n entregamos?">
        <input type="text" id="direccion" placeholder="Direcci√≥n exacta">
        <select id="modalidad" onchange="render()">
            <option value="reparto">üöö Servicio de Reparto (12:45 - 13:30)</option>
            <option value="retiro">üè† Retiro en Cocina Taller (-$500)</option>
        </select>
        <select id="zona" onchange="render()">
            <option value="0">Centro hasta Victoria (GRATIS)</option>
            <option value="1500">Victoria hacia la Monta√±a (+$1.500)</option>
        </select>
        <div id="msg-log" style="font-size: 0.75rem; padding: 8px; border-radius: 8px; display:none;"></div>
    </div>

    <div class="card">
        <div class="step-title">üß© Paso 2: Arma tu Plato</div>
        <div class="grid-combos">
            <label class="combo-card"><input type="radio" name="combo" value="7500" data-name="Men√∫ A" onclick="checkUI('A')"><b>Men√∫ A</b><span>Principal</span><i>$7.500</i></label>
            <label class="combo-card"><input type="radio" name="combo" value="8500" data-name="Men√∫ B" onclick="checkUI('B')"><b>Men√∫ B</b><span>Entrante+Prin.</span><i>$8.500</i></label>
            <label class="combo-card"><input type="radio" name="combo" value="3500" data-name="Sopa" onclick="checkUI('S')"><b>Sopa</b><span>500cc</span><i>$3.500</i></label>
            <label class="combo-card"><input type="radio" name="combo" value="3500" data-name="Dulce" onclick="checkUI('D')"><b>Dulce</b><span>Artesanal</span><i>$3.500</i></label>
        </div>

        <div id="promo-box" onclick="aplicarPromo()" style="margin-top:15px; display:none; background: #fff9db; border: 2px dashed var(--gold); padding: 12px; border-radius: 15px; text-align: center; cursor: pointer;">
            ‚ú® <b>¬°EXPERIENCIA COMPLETA!</b> ‚ú®<br><small>Suma tu Dulce por solo <b>+$2.000</b></small>
        </div>

        <div id="ui-principal" style="display:none; margin-top:15px;">
            <select id="principal_val" onchange="render()">
                <option value="Plato del D√≠a">ü•ò Plato del D√≠a</option>
                <option value="La Gran Ensalada">ü•ó La Gran Ensalada (Elige 2 Prote√≠nas)</option>
            </select>
        </div>

        <button id="btn-add-main" onclick="addItem()" class="btn-add">A√ëADIR AL PEDIDO</button>
    </div>

    <div id="resumen-seccion" class="card" style="display:none;">
        <div class="step-title">üõí Tu Selecci√≥n</div>
        <div id="items_cart"></div>
        <div id="ahorro_box" class="ahorro-tag"></div>
    </div>

    <div class="card">
        <div class="step-title">üí∞ Paso 3: Pago</div>
        <select id="pago" onchange="render()">
            <option value="">Selecciona medio de pago...</option>
            <option value="Transferencia">üì≤ Transferencia (-$500)</option>
            <option value="Efectivo">üíµ Efectivo</option>
        </select>
        <div id="info-pago" style="font-size: 0.8rem; background: #f8fafc; padding: 10px; border-radius: 10px; display:none;"></div>
    </div>

    <div class="total-box">
        <span style="font-size: 0.9rem; opacity: 0.8;">Total a Pagar</span>
        <div id="total_final" style="font-size: 1.8rem; font-weight: 800;">$0</div>
    </div>

    <button class="btn-send" onclick="send()">CONFIRMAR PEDIDO ‚úÖ</button>
</div>

<script>
    let cart = []; let totalGlobal = 0;

    function checkUI(t) {
        document.getElementById('ui-principal').style.display = (t==='A' || t==='B') ? 'block' : 'none';
        render();
    }

    function addItem() {
        const c = document.querySelector('input[name="combo"]:checked');
        if(!c) return;
        cart.push({ name: c.dataset.name, price: parseInt(c.value), isPromo: false });
        c.checked = false;
        render();
    }

    function aplicarPromo() {
        cart.push({ name: "Dulce (Promo)", price: 2000, isPromo: true });
        render();
    }

    function render() {
        const itemsDiv = document.getElementById('items_cart');
        const resumenSec = document.getElementById('resumen-seccion');
        itemsDiv.innerHTML = ""; let sub = 0; let ahorro = 0;

        resumenSec.style.display = cart.length > 0 ? 'block' : 'none';
        
        cart.forEach((it, i) => {
            sub += it.price;
            if(it.isPromo) ahorro += 1500;
            itemsDiv.innerHTML += `<div class="cart-item"><b>${it.name}</b> <span>$${it.price.toLocaleString()} <small onclick="cart.splice(${i},1);render()" style="color:red; margin-left:10px;">‚úï</small></span></div>`;
        });

        const mod = document.getElementById('modalidad').value;
        const pago = document.getElementById('pago').value;
        const zona = parseInt(document.getElementById('zona').value);

        if(mod === 'retiro') ahorro += 500;
        if(pago === 'Transferencia') ahorro += 500;

        // Mostrar ahorro
        const aBox = document.getElementById('ahorro_box');
        aBox.style.display = ahorro > 0 ? 'block' : 'none';
        aBox.innerHTML = `üî• ¬°Est√°s ahorrando $${ahorro.toLocaleString()}!`;

        // Brillo Bot√≥n
        const btn = document.getElementById('btn-add-main');
        if(document.querySelector('input[name="combo"]:checked')) btn.classList.add('btn-add-active');
        else btn.classList.remove('btn-add-active');

        // Mostrar Promo Postre si hay Men√∫
        document.getElementById('promo-box').style.display = cart.some(it => it.name.includes("Men√∫")) ? 'block' : 'none';

        totalGlobal = sub + (mod === 'reparto' ? zona : -500) + (pago === 'Transferencia' ? -500 : 0);
        document.getElementById('total_final').innerText = "$" + totalGlobal.toLocaleString('es-CL');
    }

    function send() {
        if(!document.getElementById('nombre').value || cart.length === 0) return alert("Completa los datos.");
        const msg = `*NUEVO PEDIDO PATAGON*%0Aüë§ Cliente: ${document.getElementById('nombre').value}%0Aüí∞ Total: $${totalGlobal.toLocaleString()}`;
        window.open(`https://wa.me/56994004188?text=${msg}`);
    }
</script>
</body>
    </html>
    
