<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gourmet Patagon - Pedido y Pago</title>
    <style>
        :root { --primary: #e67e22; --dark: #2c3e50; --success: #25d366; --bg: #fdfaf6; }
        body { font-family: 'Segoe UI', sans-serif; background: var(--bg); color: var(--dark); padding: 10px; margin: 0; }
        .container { max-width: 480px; margin: auto; background: white; padding: 15px; border-radius: 25px; box-shadow: 0 10px 30px rgba(0,0,0,0.1); }
        .header { text-align: center; margin-bottom: 20px; border-bottom: 2px solid var(--primary); padding-bottom: 10px; }
        .step-title { font-size: 0.9rem; color: var(--primary); text-transform: uppercase; font-weight: 800; margin: 15px 0 10px; border-bottom: 1px solid #eee; }
        
        .grid-combos { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; }
        .combo-card { border: 2px solid #f0f0f0; padding: 12px; border-radius: 15px; text-align: center; cursor: pointer; position: relative; }
        .combo-card input { position: absolute; opacity: 0; }
        .combo-card:has(input:checked) { border-color: var(--primary); background: #fff5eb; border-width: 2px; }

        .selector-box { background: #f9f9f9; padding: 15px; border-radius: 15px; margin-bottom: 10px; display: none; border-left: 5px solid var(--primary); }
        select, input { width: 100%; padding: 12px; margin: 8px 0; border: 1px solid #ddd; border-radius: 10px; font-size: 1rem; box-sizing: border-box; }
        
        .bank-data { background: #eef2f7; padding: 15px; border-radius: 12px; font-size: 0.85rem; margin-top: 10px; border: 1px dashed var(--dark); display: none; }
        .cash-data { display: none; margin-top: 10px; }
        
        .cart-item { background: #eee; padding: 10px; border-radius: 8px; margin: 5px 0; font-size: 0.85rem; }
        .total-banner { background: var(--dark); color: white; padding: 15px; border-radius: 15px; text-align: center; font-weight: bold; font-size: 1.2rem; margin: 15px 0; }
        
        button { width: 100%; border: none; border-radius: 12px; cursor: pointer; font-weight: bold; transition: 0.3s; }
        .btn-add { background: var(--primary); color: white; padding: 12px; margin-top: 5px; }
        .btn-send { background: var(--success); color: white; padding: 18px; font-size: 1.1rem; margin-top: 10px; }
    </style>
</head>
<body>

<div class="container">
    <div class="header">
        <h2>üèîÔ∏è EL GOURMET PATAGON</h2>
        <span>Cocina Taller - Coyhaique</span>
    </div>

    <div class="step-title">1. Datos de Entrega üöö</div>
    <input type="text" id="nombre" placeholder="Nombre completo">
    <input type="text" id="direccion" placeholder="Direcci√≥n de despacho">
    <select id="zona" onchange="render()">
        <option value="0">Retiro / Centro hasta Victoria ($0)</option>
        <option value="1500">Sobre Victoria (+$1.500)</option>
    </select>

    <div class="step-title">2. Arma tu Combo üß©ü•ä</div>
    <div class="grid-combos">
        <label class="combo-card"><input type="radio" name="combo" value="6500" data-name="Men√∫ A" onclick="toggleUI('A')"><b>Men√∫ A</b><span>$6.500</span></label>
        <label class="combo-card"><input type="radio" name="combo" value="7500" data-name="Men√∫ B" onclick="toggleUI('B')"><b>Men√∫ B</b><span>$7.500</span></label>
        <label class="combo-card"><input type="radio" name="combo" value="3500" data-name="Sopa/Crema" onclick="toggleUI('S')"><b>Sopa/Crema</b><span>$3.500</span></label>
        <label class="combo-card"><input type="radio" name="combo" value="3500" data-name="Dulce" onclick="toggleUI('D')"><b>Dulce</b><span>$3.500</span></label>
    </div>

    <div id="ui-entrante" class="selector-box">
        <label><b>Entrante:</b></label>
        <select id="entrante_val">
            <option value="Sopa/Crema del d√≠a">ü•£ Sopa o Crema</option>
            <option value="Mix de Temporada">ü•ó Mix de Temporada</option>
        </select>
    </div>

    <div id="ui-principal" class="selector-box">
        <label><b>Principal:</b></label>
        <select id="principal_val" onchange="document.getElementById('ui-prot').style.display=(this.value.includes('Ensalada')?'block':'none')">
            <option value="Plato del D√≠a">ü•ò Plato del D√≠a</option>
            <option value="La Gran Ensalada">ü•ó La Gran Ensalada</option>
        </select>
        <div id="ui-prot" style="display:none; font-size:0.8rem; margin-top:5px;">
            <b>2 Prote√≠nas:</b><br>
            <input type="checkbox" class="p-check" value="Suprema"> Suprema | <input type="checkbox" class="p-check" value="Huevo"> Huevo | <input type="checkbox" class="p-check" value="Quinoa"> Quinoa | <input type="checkbox" class="p-check" value="Legumbres"> Legumbres
        </div>
    </div>

    <button class="btn-add" onclick="addItem()">‚ûï A√ëADIR AL PEDIDO</button>
    <div id="resumen_cart" style="margin-top:10px;"></div>

    <div class="step-title">3. Forma de Pago üí∞</div>
    <select id="pago" onchange="togglePago()">
        <option value="">Selecciona c√≥mo pagas...</option>
        <option value="Transferencia">Transferencia Bancaria</option>
        <option value="Efectivo">Efectivo</option>
        <option value="Tarjeta" disabled>Tarjeta D√©bito (Pr√≥ximamente)</option>
    </select>

    <div id="info-transferencia" class="bank-data">
        <b>DATOS DE TRANSFERENCIA:</b><br>
        Titular: ALEX ANDRE BERRIOS<br>
        RUT: 15.841.237-3<br>
        Banco: BCI<br>
        Cuenta Corriente: 30763118<br>
        <i>Enviar comprobante por este medio.</i>
    </div>

    <div id="info-efectivo" class="cash-data">
        <input type="text" id="vuelto" placeholder="¬øCon cu√°nto pagas? (Para el vuelto)">
    </div>

    <label style="display:block; margin:15px 0; font-size:0.85rem;">
        <input type="checkbox" id="cubiertos" onchange="render()"> üéã Cubiertos Bamboo (+$1.000)
    </label>

    <div class="total-banner" id="total_final">TOTAL: $0</div>
    <button class="btn-send" onclick="send()">ENVIAR A WHATSAPP ‚úÖ</button>
</div>

<script>
    let cart = [];
    function toggleUI(t){
        document.getElementById('ui-entrante').style.display=(t==='B')?'block':'none';
        document.getElementById('ui-principal').style.display=(t==='A'||t==='B')?'block':'none';
    }
    function togglePago(){
        const v = document.getElementById('pago').value;
        document.getElementById('info-transferencia').style.display=(v==='Transferencia')?'block':'none';
        document.getElementById('info-efectivo').style.display=(v==='Efectivo')?'block':'none';
    }
    function addItem(){
        const c = document.querySelector('input[name="combo"]:checked');
        if(!c) return alert("Selecciona un combo");
        const prots = Array.from(document.querySelectorAll('.p-check:checked')).map(p => p.value);
        cart.push({
            name: c.dataset.name, price: parseInt(c.value),
            ent: (c.dataset.name==='Men√∫ B')?document.getElementById('entrante_val').value:'',
            pri: (c.dataset.name.includes('Men√∫'))?document.getElementById('principal_val').value:'',
            pts: prots.join("/")
        });
        render();
    }
    function render(){
        const res = document.getElementById('resumen_cart');
        res.innerHTML = "";
        let sub = 0;
        cart.forEach((it, i) => {
            sub += it.price;
            res.innerHTML += `<div class="cart-item">${it.name} ${it.ent} ${it.pri} [${it.pts}] <span onclick="cart.splice(${i},1);render()" style="float:right;color:red">‚úñ</span></div>`;
        });
        const z = parseInt(document.getElementById('zona').value);
        const cb = document.getElementById('cubiertos').checked ? 1000 : 0;
        document.getElementById('total_final').innerText = "TOTAL: $" + (sub + z + cb).toLocaleString('es-CL');
    }
    function send(){
        const n = document.getElementById('nombre').value;
        const p = document.getElementById('pago').value;
        if(!n || cart.length === 0 || !p) return alert("Faltan datos, productos o m√©todo de pago.");
        
        let msg = `*COMANDA - EL GOURMET PATAGON*%0Aüë§ *Cliente:* ${n}%0Aüìç *Direcci√≥n:* ${document.getElementById('direccion').value}%0A%0A`;
        cart.forEach((it, i) => { msg += `üç¥ *Item ${i+1}:* ${it.name} (${it.ent} ${it.pri} ${it.pts})%0A`; });
        
        msg += `%0Aüí≥ *Pago:* ${p}`;
        if(p==='Efectivo') msg += ` (Paga con: ${document.getElementById('vuelto').value})`;
        msg += `%0Aüí∞ *${document.getElementById('total_final').innerText}*`;
        msg += `%0Aüïí *Despacho:* 12:45-13:30 (Aceptado)`;

        window.open(`https://wa.me/56994004188?text=${msg}`);
    }
</script>
</body>
</html>
